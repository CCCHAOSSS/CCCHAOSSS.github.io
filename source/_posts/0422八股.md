---
title: 0422八股
date: 2024-04-22 09:53:31
categories: 八股
tags: 
    - Java
    - JVM
    - 数据库
---
# 八股0422_JVM_GC
虽然不想背但是实验室突然断网了，只能背背喽
<!-- more-->
## JVM
### JVM内存结构
线程私有：
* 程序计数器
* 本地方法栈
* java虚拟机栈

线程共享：
* 堆（存放对象，分为新生代和老年代）
* 方法区

### 作用
1. 程序计数器：和程序运行到哪里有关
2. 本地方法栈（C栈），栈帧
3. 虚拟机栈，运行速度快（仅次于程序计数器）

4. 堆，整个JVM只有一个，垃圾回收的主要场所
> 对象分配时候在堆中新生代Eden区（还有survivor0和survivor1）
5. 方法区，堆发逻辑部分，线程共享。存放已经背虚拟机加载的类信息、常量、静态变量、即时编译后代码

### 内存分配
对象优先在新生代的Eden区，大对象（Eden放不下）直接进入老年代。

长期存活对象（GC存活次数）进入老年代。


## 垃圾回收策略与算法

### Minor GC与Full GC
* Minor GC：回收新生代，速度快，非常频繁
* Full GC：回收老年代，经常会伴随至少一次Minor GC，速度很慢

**触发FullGC的操作**：

①调用system.gc（建议Fullgc但不一定发生）

②统计得到的MinorGC晋升到老年代的平均大小大于老年代剩余空间

③担保失败

### **（堆）回收谁？**
-->无效**对象**

**如何判断无效？**
-->不被任何对象或变量引用则无效

**引用种类**
--> 强引用、软引用、弱引用、虚引用

**如何分析引用**
--> 引用技术法、可达性分析法

### **（方法区）回收谁**
--> 废弃常量、无用的类

**判断回收**
-->废弃**常量**
-->无用的**类**

## 垃圾收集算法
1. 标记-清除算法
    * 优：（……没有？）
    * 缺：空间、时间效率都不高；产生大量不连续碎片
2. 复制算法（新生代）
    * 优：不会有内存碎片的问题
    * 缺：内存空间减少一半
3. 标记-整理算法（老年代）
    * 老年代的垃圾收集算法，不采用复制是因为老年代的对象都比较大，效率比较低
4. 分代收集算法
   * 新生代：复制算法
   * 老年代：标记-清除；标记-整理


## Class文件
类文件

* 符号引用：就是定义的各种名字：**类和接口的限定全名**、字段的名字和描述符、**方法的名字和描述符**

## 类加载
过程： 加载、验证、准备、解析、初始化。

* 解析：将常量池内的符号引用替换为直接引用的过程